services:
  puzzle-generator:
    build:
      context: ./services/puzzle-generator
      dockerfile: Dockerfile
    container_name: puzzle-generator
    restart: unless-stopped
    ports:
      - "${PUZZLE_GENERATOR_PORT:-8080}:8080"
    environment:
      SERVER_PORT: "8080"
      SERVER_READ_TIMEOUT: "15s"
      SERVER_WRITE_TIMEOUT: "15s"
      LICHESS_BASE_URL: "${LICHESS_BASE_URL:-https://lichess.org}"
      LICHESS_API_TOKEN: "${LICHESS_API_TOKEN:-}"
      LICHESS_TIMEOUT: "10s"
    networks:
      - chess-net
    healthcheck:
      test: [ "CMD", "wget", "-qO-", "http://localhost:8080/health" ]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s

networks:
  chess-net:
    driver: bridge